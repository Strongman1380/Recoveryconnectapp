<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Pledges - Recovery Connect</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Figtree:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-teal: #06b6d4;
            --primary-coral: #f97316;
            --primary-amber: #f59e0b;
            --secondary-purple: #8b5cf6;
            --secondary-pink: #ec4899;
            --accent-lime: #84cc16;
            --neutral-dark: #0f172a;
            --neutral-medium: #334155;
            --neutral-light: #f8fafc;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-light: #ffffff;
            --shadow-brutal: 8px 8px 0px #0f172a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Figtree', sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background: var(--neutral-light);
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .header h1 {
            font-size: 3rem;
            font-weight: 900;
            color: var(--neutral-dark);
            margin-bottom: 1rem;
            text-transform: uppercase;
            font-family: 'JetBrains Mono', monospace;
        }

        .header p {
            font-size: 1.2rem;
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto;
        }

        .today-section {
            background: white;
            border: 4px solid var(--neutral-dark);
            box-shadow: var(--shadow-brutal);
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .date-display {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-teal);
            margin-bottom: 1rem;
            font-family: 'JetBrains Mono', monospace;
        }

        .pledge-text {
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--neutral-dark);
            margin: 2rem 0;
            line-height: 1.4;
            font-style: italic;
        }

        .pledge-status {
            margin: 2rem 0;
        }

        .status-complete {
            color: var(--accent-lime);
            font-size: 1.2rem;
            font-weight: 700;
        }

        .status-pending {
            color: var(--primary-coral);
            font-size: 1.2rem;
            font-weight: 700;
        }

        .btn {
            padding: 1.5rem 3rem;
            background: var(--primary-teal);
            color: white;
            border: 4px solid var(--neutral-dark);
            box-shadow: var(--shadow-brutal);
            font-weight: 700;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            font-family: 'JetBrains Mono', monospace;
            margin: 0.5rem;
        }

        .btn:hover {
            transform: translate(-2px, -2px);
            box-shadow: 10px 10px 0px var(--neutral-dark);
        }

        .btn-success {
            background: var(--accent-lime);
        }

        .btn-secondary {
            background: var(--primary-coral);
        }

        .btn:disabled {
            background: var(--neutral-medium);
            cursor: not-allowed;
            opacity: 0.6;
        }

        .btn:disabled:hover {
            transform: none;
            box-shadow: var(--shadow-brutal);
        }

        .pledge-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .pledge-option {
            background: var(--neutral-light);
            border: 3px solid var(--neutral-dark);
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .pledge-option:hover {
            background: var(--primary-teal);
            color: white;
            transform: translate(-2px, -2px);
            box-shadow: 4px 4px 0px var(--neutral-dark);
        }

        .pledge-option.selected {
            background: var(--primary-teal);
            color: white;
            box-shadow: 4px 4px 0px var(--neutral-dark);
        }

        .custom-pledge {
            margin-top: 2rem;
        }

        .custom-pledge textarea {
            width: 100%;
            padding: 1rem;
            border: 3px solid var(--neutral-dark);
            background: var(--neutral-light);
            font-family: 'Figtree', sans-serif;
            font-size: 1rem;
            resize: vertical;
            min-height: 100px;
        }

        .custom-pledge textarea:focus {
            outline: none;
            box-shadow: 4px 4px 0px var(--primary-teal);
        }

        .streak-display {
            background: var(--accent-lime);
            color: white;
            padding: 2rem;
            border: 4px solid var(--neutral-dark);
            box-shadow: var(--shadow-brutal);
            text-align: center;
            margin-bottom: 2rem;
        }

        .streak-number {
            font-size: 4rem;
            font-weight: 900;
            font-family: 'JetBrains Mono', monospace;
        }

        .streak-label {
            font-size: 1.2rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .history-section {
            background: white;
            border: 4px solid var(--neutral-dark);
            box-shadow: var(--shadow-brutal);
            padding: 2rem;
            margin-top: 2rem;
        }

        .history-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--neutral-dark);
            margin-bottom: 1rem;
            text-transform: uppercase;
            font-family: 'JetBrains Mono', monospace;
        }

        .history-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .history-day {
            width: 50px;
            height: 50px;
            border: 2px solid var(--neutral-dark);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
        }

        .history-day.completed {
            background: var(--accent-lime);
            color: white;
        }

        .history-day.missed {
            background: var(--primary-coral);
            color: white;
        }

        .history-day.today {
            border-color: var(--primary-teal);
            border-width: 3px;
        }

        .motivational-quotes {
            background: var(--secondary-purple);
            color: white;
            padding: 2rem;
            border: 4px solid var(--neutral-dark);
            box-shadow: var(--shadow-brutal);
            margin-top: 2rem;
            text-align: center;
        }

        .quote-text {
            font-size: 1.3rem;
            font-style: italic;
            margin-bottom: 1rem;
        }

        .quote-author {
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .pledge-text {
                font-size: 1.4rem;
            }
            
            .btn {
                padding: 1rem 2rem;
                font-size: 1rem;
            }
            
            .streak-number {
                font-size: 3rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-hands-praying"></i> Daily Pledges</h1>
            <p>Start each day with a personal commitment to your recovery. Make your pledge and strengthen your resolve one day at a time.</p>
        </div>

        <div class="streak-display" id="streakDisplay">
            <div class="streak-number" id="streakNumber">0</div>
            <div class="streak-label">Day Pledge Streak</div>
        </div>

        <div class="today-section">
            <div class="date-display" id="dateDisplay"></div>
            
            <div id="pledgeContent">
                <h3 style="margin-bottom: 1rem; color: var(--neutral-dark);">Choose Your Daily Pledge</h3>
                
                <div class="pledge-options">
                    <div class="pledge-option" data-pledge="Today I commit to staying sober and choosing my recovery one moment at a time.">
                        <strong>Sobriety Commitment</strong><br>
                        <small>Focus on staying sober today</small>
                    </div>
                    <div class="pledge-option" data-pledge="Today I will be kind to myself and remember that recovery is a journey, not a destination.">
                        <strong>Self-Compassion</strong><br>
                        <small>Practice self-kindness</small>
                    </div>
                    <div class="pledge-option" data-pledge="Today I will reach out for support when I need it and remember that I am not alone.">
                        <strong>Connection & Support</strong><br>
                        <small>Stay connected to community</small>
                    </div>
                    <div class="pledge-option" data-pledge="Today I will take things one step at a time and trust in my ability to overcome challenges.">
                        <strong>One Day at a Time</strong><br>
                        <small>Focus on the present moment</small>
                    </div>
                    <div class="pledge-option" data-pledge="Today I will practice gratitude and focus on the positive changes recovery has brought to my life.">
                        <strong>Gratitude Practice</strong><br>
                        <small>Appreciate your progress</small>
                    </div>
                    <div class="pledge-option" data-pledge="Today I will honor my commitment to health and make choices that support my wellbeing.">
                        <strong>Health & Wellness</strong><br>
                        <small>Prioritize your health</small>
                    </div>
                </div>

                <div class="custom-pledge">
                    <h4 style="margin-bottom: 1rem; color: var(--neutral-dark);">Or Create Your Own Pledge:</h4>
                    <textarea id="customPledgeText" placeholder="Write your personal pledge for today..."></textarea>
                </div>

                <div style="margin-top: 2rem;">
                    <button class="btn" onclick="showSelectedPledge()">Preview Pledge</button>
                    <button class="btn btn-secondary" onclick="getRandomPledge()">Surprise Me</button>
                </div>
            </div>

            <div id="pledgePreview" style="display: none;">
                <div class="pledge-text" id="selectedPledgeText"></div>
                <div class="pledge-status" id="pledgeStatus">
                    <div class="status-pending">
                        <i class="fas fa-clock"></i> Pledge Pending
                    </div>
                </div>
                <div>
                    <button class="btn btn-success" onclick="makePledge()">
                        <i class="fas fa-heart"></i> Make This Pledge
                    </button>
                    <button class="btn" onclick="backToSelection()">Choose Different</button>
                </div>
            </div>

            <div id="pledgeComplete" style="display: none;">
                <div class="pledge-text" id="completedPledgeText"></div>
                <div class="pledge-status">
                    <div class="status-complete">
                        <i class="fas fa-check-circle"></i> Pledge Made for Today!
                    </div>
                </div>
                <div>
                    <button class="btn" onclick="sharePledge()">
                        <i class="fas fa-share"></i> Share Pledge
                    </button>
                    <button class="btn btn-secondary" onclick="resetPledge()">New Pledge Tomorrow</button>
                </div>
            </div>
        </div>

        <div class="motivational-quotes" id="motivationalQuote">
            <div class="quote-text" id="quoteText"></div>
            <div class="quote-author" id="quoteAuthor"></div>
        </div>

        <div class="history-section">
            <h3 class="history-title">Your Pledge History</h3>
            <p style="color: var(--text-secondary); margin-bottom: 1rem;">Track your daily commitment streak. Each day you make a pledge strengthens your recovery journey.</p>
            <div class="history-grid" id="historyGrid">
                <!-- History calendar will be generated here -->
            </div>
        </div>
    </div>

    <script>
        // Daily pledge data
        let pledgeData = JSON.parse(localStorage.getItem('dailyPledges')) || {
            streak: 0,
            lastPledgeDate: null,
            history: {},
            totalPledges: 0
        };

        const inspirationalQuotes = [
            { text: "Recovery is not a race. You don't have to feel guilty if it takes you longer than you thought it would.", author: "Recovery Wisdom" },
            { text: "The opposite of addiction is not sobriety. The opposite of addiction is connection.", author: "Johann Hari" },
            { text: "You are stronger than your strongest excuse.", author: "Recovery Motivation" },
            { text: "Progress, not perfection.", author: "Recovery Principle" },
            { text: "Each day is a new opportunity to choose recovery.", author: "Daily Affirmation" },
            { text: "Recovery is about progression, not perfection.", author: "Recovery Wisdom" },
            { text: "You have been assigned this mountain to show others it can be moved.", author: "Motivational" },
            { text: "Rock bottom became the solid foundation on which I rebuilt my life.", author: "J.K. Rowling" }
        ];

        const pledgeTemplates = [
            "Today I commit to staying sober and choosing my recovery one moment at a time.",
            "Today I will be kind to myself and remember that recovery is a journey, not a destination.",
            "Today I will reach out for support when I need it and remember that I am not alone.",
            "Today I will take things one step at a time and trust in my ability to overcome challenges.",
            "Today I will practice gratitude and focus on the positive changes recovery has brought to my life.",
            "Today I will honor my commitment to health and make choices that support my wellbeing.",
            "Today I will stay present and mindful, avoiding thoughts that lead me away from recovery.",
            "Today I will remember my why - the reasons I chose recovery in the first place.",
            "Today I will celebrate small victories and acknowledge my progress.",
            "Today I will be patient with myself and trust the recovery process."
        ];

        function initializePage() {
            const today = new Date().toDateString();
            document.getElementById('dateDisplay').textContent = new Date().toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });

            // Check if pledge already made today
            if (pledgeData.history[today]) {
                showCompletedPledge(pledgeData.history[today].pledge);
            }

            updateStreakDisplay();
            generateHistoryCalendar();
            showRandomQuote();
        }

        function showSelectedPledge() {
            const selected = document.querySelector('.pledge-option.selected');
            const customText = document.getElementById('customPledgeText').value.trim();
            
            let pledgeText = '';
            if (customText) {
                pledgeText = customText;
            } else if (selected) {
                pledgeText = selected.dataset.pledge;
            } else {
                showToast('Please select a pledge or write your own');
                return;
            }

            document.getElementById('selectedPledgeText').textContent = pledgeText;
            document.getElementById('pledgeContent').style.display = 'none';
            document.getElementById('pledgePreview').style.display = 'block';
        }

        function makePledge() {
            const pledgeText = document.getElementById('selectedPledgeText').textContent;
            const today = new Date().toDateString();

            // Save pledge
            pledgeData.history[today] = {
                pledge: pledgeText,
                timestamp: Date.now()
            };
            pledgeData.lastPledgeDate = today;
            pledgeData.totalPledges++;

            // Update streak
            updateStreak();
            
            // Save to localStorage
            localStorage.setItem('dailyPledges', JSON.stringify(pledgeData));

            showCompletedPledge(pledgeText);
            updateStreakDisplay();
            generateHistoryCalendar();

            showToast('Pledge made! Your commitment strengthens your recovery journey.');
        }

        function showCompletedPledge(pledgeText) {
            document.getElementById('completedPledgeText').textContent = pledgeText;
            document.getElementById('pledgeContent').style.display = 'none';
            document.getElementById('pledgePreview').style.display = 'none';
            document.getElementById('pledgeComplete').style.display = 'block';
        }

        function backToSelection() {
            document.getElementById('pledgeContent').style.display = 'block';
            document.getElementById('pledgePreview').style.display = 'none';
        }

        function resetPledge() {
            document.getElementById('pledgeContent').style.display = 'block';
            document.getElementById('pledgeComplete').style.display = 'none';
            
            // Clear selections
            document.querySelectorAll('.pledge-option').forEach(option => {
                option.classList.remove('selected');
            });
            document.getElementById('customPledgeText').value = '';
        }

        function getRandomPledge() {
            const randomPledge = pledgeTemplates[Math.floor(Math.random() * pledgeTemplates.length)];
            document.getElementById('customPledgeText').value = randomPledge;
            
            // Clear other selections
            document.querySelectorAll('.pledge-option').forEach(option => {
                option.classList.remove('selected');
            });
        }

        function updateStreak() {
            const today = new Date();
            const yesterday = new Date(today);
            yesterday.setDate(yesterday.getDate() - 1);
            
            const todayStr = today.toDateString();
            const yesterdayStr = yesterday.toDateString();

            if (pledgeData.lastPledgeDate === yesterdayStr) {
                pledgeData.streak++;
            } else if (pledgeData.lastPledgeDate !== todayStr) {
                pledgeData.streak = 1; // Reset streak but start with 1 for today
            }
        }

        function updateStreakDisplay() {
            document.getElementById('streakNumber').textContent = pledgeData.streak;
        }

        function generateHistoryCalendar() {
            const historyGrid = document.getElementById('historyGrid');
            const today = new Date();
            const thirtyDaysAgo = new Date(today);
            thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);

            let html = '';
            for (let d = new Date(thirtyDaysAgo); d <= today; d.setDate(d.getDate() + 1)) {
                const dateStr = d.toDateString();
                const dayOfMonth = d.getDate();
                const isToday = dateStr === today.toDateString();
                const hasPledge = pledgeData.history[dateStr];

                let className = 'history-day';
                if (isToday) className += ' today';
                if (hasPledge) className += ' completed';
                else if (d < today) className += ' missed';

                html += `<div class="${className}" title="${d.toLocaleDateString()}">${dayOfMonth}</div>`;
            }

            historyGrid.innerHTML = html;
        }

        function showRandomQuote() {
            const randomQuote = inspirationalQuotes[Math.floor(Math.random() * inspirationalQuotes.length)];
            document.getElementById('quoteText').textContent = `"${randomQuote.text}"`;
            document.getElementById('quoteAuthor').textContent = `— ${randomQuote.author}`;
        }

        function sharePledge() {
            const pledgeText = document.getElementById('completedPledgeText').textContent;
            if (navigator.share) {
                navigator.share({
                    title: 'My Daily Recovery Pledge',
                    text: pledgeText,
                    url: window.location.href
                });
            } else {
                // Fallback for browsers without Web Share API
                const shareText = `My Daily Recovery Pledge: ${pledgeText}`;
                navigator.clipboard.writeText(shareText).then(() => {
                    showToast('Pledge copied to clipboard!');
                });
            }
        }

        function showToast(message) {
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--primary-teal);
                color: white;
                padding: 1rem 2rem;
                border: 3px solid var(--neutral-dark);
                box-shadow: 4px 4px 0px var(--neutral-dark);
                z-index: 1000;
                font-weight: 600;
                max-width: 300px;
            `;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                document.body.removeChild(toast);
            }, 3000);
        }

        // Event listeners
        document.querySelectorAll('.pledge-option').forEach(option => {
            option.addEventListener('click', () => {
                document.querySelectorAll('.pledge-option').forEach(opt => opt.classList.remove('selected'));
                option.classList.add('selected');
                document.getElementById('customPledgeText').value = '';
            });
        });

        document.getElementById('customPledgeText').addEventListener('input', () => {
            document.querySelectorAll('.pledge-option').forEach(opt => opt.classList.remove('selected'));
        });

        // Initialize page
        initializePage();
    </script>
</body>
</html>